<% if defined?(@context) && !@context.blank? %>
<div class="clear">
	<h2>Debug breadcrumb</h2>
    <%= debug @context %>

    <h2>Updated breadcrumbs layout</h2>
    <% if @context && @context.length > 2 %>
    <nav aria-label="hierarchical navigation">
        <ul class="breadcrumb">
            <% @context.each do |bread| %>
                <% if bread[:crumb] && bread[:type] && bread[:type] != "repository"; crumb = bread[:crumb]; crumb += " (#{bread[:identifier]})" if bread[:identifier] %>
                <li>
                    <%= badge_for_type(bread[:type]) %>
                    <% if bread[:uri].blank? %>
                        <%= process_mixed_content(crumb).html_safe %>
                    <% else %>
                        <a href='<%=app_prefix(bread[:uri]) %>'>
                            <%= process_mixed_content(crumb).html_safe %>
                        </a>
                    <% end %>
                </li>
                <% end %>
            <% end %>
        </ul>
    </nav>
    <% else %>
    <nav aria-label="hierarchical navigation">
        <ul class="breadcrumb">
            <li>none</li>
        </ul>
    </nav>
    <% end %>

    <h2>Original breadcrumbs layout</h2>
    <nav aria-label="hierarchical navigation">
      <ul class="breadcrumb">
	<% @context.each do |bread| %>
	<% if bread[:crumb]; crumb = bread[:crumb]; crumb += " (#{bread[:identifier]})" if bread[:identifier] %>
	<li>
	  <%= badge_for_type(bread[:type]) %>
	  <% if bread[:uri].blank? %>
	    <%= process_mixed_content(crumb).html_safe %>
	  <% else %>
	    <a href='<%=app_prefix(bread[:uri]) %>'>
		<%= process_mixed_content(crumb).html_safe %>
	    </a>
	  <% end %>
	</li>
	<% end %>
	<% end %>
      </ul>
    </nav>
</div>
<% end %>
